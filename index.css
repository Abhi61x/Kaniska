@tailwind base;
@tailwind components;
@tailwind utilities;

/* ... Existing Styles ... */

/* Native App Feel Overrides */
html, body {
  margin: 0; 
  padding: 0; 
  background-color: #000; 
  color: white; 
  overflow: hidden; /* Prevent bounce scroll */
  height: 100%;
  width: 100%;
  user-select: none; /* Disable text selection like an app */
  -webkit-user-select: none;
  touch-action: manipulation; /* Optimize touch */
  -webkit-tap-highlight-color: transparent; /* Remove blue tap box */
  overscroll-behavior: none; /* Prevent rubber banding */
}

/* Prevent iOS Zoom on focus */
input, select, textarea {
  font-size: 16px !important;
}

/* Theme Variables */
:root {
  --panel-bg: rgba(15, 15, 20, 0.98);
  --border-color: rgba(255, 255, 255, 0.15);
  --text-color: rgba(255, 255, 255, 0.95);
  --assistant-bubble-bg: rgba(40, 40, 50, 0.9);
  
  /* Safe Area Insets for Mobile Notches/Bars */
  --safe-top: env(safe-area-inset-top, 20px);
  --safe-bottom: env(safe-area-inset-bottom, 20px);
  --safe-left: env(safe-area-inset-left, 0px);
  --safe-right: env(safe-area-inset-right, 0px);

  /* Default Avatar Color (Cyan) - RGB values for rgba usage */
  --avatar-rgb: 34, 211, 238; 
}

/* Mood-based Color Overrides */
.avatar-mood-neutral { --avatar-rgb: 34, 211, 238; /* Cyan */ }
.avatar-mood-happy { --avatar-rgb: 250, 204, 21; /* Yellow/Gold */ }
.avatar-mood-excited { --avatar-rgb: 236, 72, 153; /* Pink/Magenta */ }
.avatar-mood-sad { --avatar-rgb: 99, 102, 241; /* Indigo/Blue */ }
.avatar-mood-empathetic { --avatar-rgb: 20, 184, 166; /* Teal */ }
.avatar-mood-whatsapp { --avatar-rgb: 37, 211, 102; /* WhatsApp Green */ }

.bg-panel-bg { background-color: var(--panel-bg); }
.border-border-color { border-color: var(--border-color); }
.text-text-color { color: var(--text-color); }
.bg-assistant-bubble-bg { background-color: var(--assistant-bubble-bg); }
.error-bubble { background-color: rgba(127, 29, 29, 0.5); color: #fecaca; border: 1px solid rgba(239, 68, 68, 0.3); }

/* Custom Animations */
@keyframes fade-in { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
.animate-fade-in { animation: fade-in 0.4s ease-out forwards; }

/* Smooth Panel Entry */
@keyframes panel-slide-up {
  from { opacity: 0; transform: translateY(40px) scale(0.95); filter: blur(8px); }
  to { opacity: 1; transform: translateY(0) scale(1); filter: blur(0); }
}
.animate-panel-enter { animation: panel-slide-up 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards; }

.animate-spin { animation: spin 1s linear infinite; }
@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

/* Avatar Styles */
.avatar-wrap { position: relative; width: 300px; height: 300px; display: flex; justify-content: center; align-items: center; perspective: 1000px; transition: --avatar-rgb 0.5s ease; }
.avatar-container { position: relative; width: 100%; height: 100%; transform-style: preserve-3d; transition: transform 0.1s ease-out; }
.avatar-image { 
  width: 100%; 
  height: 100%; 
  object-fit: cover; 
  border-radius: 50%; 
  mask-image: radial-gradient(circle, black 60%, transparent 100%); 
  -webkit-mask-image: radial-gradient(circle, black 60%, transparent 100%); 
  transition: all 0.3s ease;
  filter: contrast(1.2) brightness(1.1) drop-shadow(0 0 10px rgba(var(--avatar-rgb), 0.3));
  opacity: 0.9;
  pointer-events: none; /* Prevent image drag */
}

/* Idle Breathing Animation */
@keyframes breathe {
  0% { transform: scale(1) translateY(0); filter: contrast(1.2) brightness(1.1) drop-shadow(0 0 10px rgba(var(--avatar-rgb), 0.3)); }
  50% { transform: scale(1.02) translateY(-3px); filter: contrast(1.2) brightness(1.2) drop-shadow(0 0 18px rgba(var(--avatar-rgb), 0.45)); }
  100% { transform: scale(1) translateY(0); filter: contrast(1.2) brightness(1.1) drop-shadow(0 0 10px rgba(var(--avatar-rgb), 0.3)); }
}

.avatar-state-idle .avatar-image { animation: breathe 4s ease-in-out infinite; }

/* Holographic Overlay Effects */
.holo-overlay { position: absolute; inset: 0; background: radial-gradient(circle, rgba(var(--avatar-rgb), 0.1) 0%, transparent 70%); pointer-events: none; mix-blend-mode: screen; z-index: 2; }
.holo-scanline {
  position: absolute; top: 0; left: 0; width: 100%; height: 100%;
  background: linear-gradient(to bottom, transparent 50%, rgba(var(--avatar-rgb), 0.05) 51%, transparent 52%);
  background-size: 100% 4px; animation: scanline 10s linear infinite; pointer-events: none; z-index: 3;
  border-radius: 50%; mask-image: radial-gradient(circle, black 60%, transparent 100%);
}

@keyframes scanline { 0% { background-position: 0 0; } 100% { background-position: 0 100%; } }

.thinking-ring { position: absolute; inset: -10px; border: 2px solid rgba(var(--avatar-rgb), 0.3); border-radius: 50%; opacity: 0; transition: all 0.5s; transform: scale(0.9); z-index: 1; }
.avatar-state-thinking .thinking-ring { opacity: 1; transform: scale(1.1) rotate(180deg); border-top-color: rgba(var(--avatar-rgb), 0.8); animation: spin 2s linear infinite; }

/* Speaking Animation */
@keyframes speak-pulse {
  0% { filter: brightness(1.2) drop-shadow(0 0 10px rgba(var(--avatar-rgb), 0.5)); transform: scale(1); }
  50% { filter: brightness(1.5) drop-shadow(0 0 25px rgba(var(--avatar-rgb), 0.8)); transform: scale(1.03); }
  100% { filter: brightness(1.2) drop-shadow(0 0 10px rgba(var(--avatar-rgb), 0.5)); transform: scale(1); }
}

.avatar-state-speaking .avatar-image { animation: speak-pulse 1.2s infinite ease-in-out; }

.speaking-ring { position: absolute; inset: 0; border-radius: 50%; border: 2px solid rgba(var(--avatar-rgb), 0.6); opacity: 0; pointer-events: none; z-index: 0; }
.avatar-state-speaking .speaking-ring { animation: ripple 2s cubic-bezier(0, 0.2, 0.8, 1) infinite; }
.avatar-state-speaking .delay-ring { animation-delay: 0.6s; }

@keyframes ripple { 0% { transform: scale(0.8); opacity: 1; } 100% { transform: scale(1.5); opacity: 0; } }

/* Utilities */
.scrollbar-hide::-webkit-scrollbar { display: none; }
.scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
.custom-scrollbar::-webkit-scrollbar { width: 6px; }
.custom-scrollbar::-webkit-scrollbar-track { background: rgba(0,0,0,0.2); }
.custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); border-radius: 3px; }

/* Safe Area Utilities */
.pt-safe { padding-top: var(--safe-top); }
.pb-safe { padding-bottom: var(--safe-bottom); }
.pl-safe { padding-left: var(--safe-left); }
.pr-safe { padding-right: var(--safe-right); }

/* --- NEW FEATURE WIDGET STYLES --- */

/* Glass Widget Base */
.feature-widget {
  background: rgba(20, 20, 25, 0.8);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  border: 1px solid rgba(255, 255, 255, 0.1);
  box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
  border-radius: 16px;
  overflow: hidden;
  transition: all 0.3s ease;
}

/* Timer Specific */
.timer-progress-ring {
  transition: stroke-dashoffset 0.35s;
  transform: rotate(-90deg);
  transform-origin: 50% 50%;
}

.timer-active {
  animation: pulse-border 2s infinite;
  border-color: rgba(34, 211, 238, 0.4);
}

@keyframes pulse-border {
  0% { box-shadow: 0 0 0 0 rgba(34, 211, 238, 0.4); }
  70% { box-shadow: 0 0 0 10px rgba(34, 211, 238, 0); }
  100% { box-shadow: 0 0 0 0 rgba(34, 211, 238, 0); }
}

/* Weather Specific */
.weather-icon-anim {
  animation: float 3s ease-in-out infinite;
}

@keyframes float {
  0% { transform: translateY(0px); }
  50% { transform: translateY(-5px); }
  100% { transform: translateY(0px); }
}
